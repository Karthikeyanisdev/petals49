<!DOCTYPE html>
<html>
<head><title>petals49</title></head>
<body>
  <h2>petals49</h2>
  <textarea id="msg" rows="3" cols="30"></textarea><br>
  <button onclick="sendMessage()">Send</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
    import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCHWbc5zAwpgddZIB4ZqJIiRtRE17SB2go",
      authDomain: "petals49-c1149.firebaseapp.com",
      databaseURL: "https://petals49-c1149-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "petals49-c1149",
      storageBucket: "petals49-c1149.firebasestorage.app",
      messagingSenderId: "642866479041",
      appId: "1:642866479041:web:5d0c2d80836d3bc8b23940",
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    async function sendMessage() {
      const msg = document.getElementById("msg").value;
      const now = new Date().toLocaleString();
      const snap = await get(child(ref(db), "messages"));
      const index = snap.exists() ? Object.keys(snap.val()).length : 0;
      set(ref(db, "messages/" + index), { text: msg, time: now });
      alert("Message sent!");
    }
  </script>
</body>
</html>
